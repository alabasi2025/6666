# ğŸ—ï¸ Ù…Ø¹Ù…Ø§Ø±ÙŠØ© Ø§ØªØµØ§Ù„ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

## 1. Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù„Ù†Ø¸Ø§Ù…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Web Browser / Client                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                  HTTP Request/Response
                         â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                               â”‚
    tRPC API                     Custom System API
    /api/trpc                    /api/custom-system/v2
         â”‚                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Express Server                    â”‚
â”‚              (PORT 5000 / 8000)                  â”‚
â”‚                                                   â”‚
â”‚  â”œâ”€ Rate Limiting (helmet)                      â”‚
â”‚  â”œâ”€ Authentication Middleware                    â”‚
â”‚  â””â”€ Context Creation                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”˜
         â”‚                                       â”‚
    [DEMO_MODE or DATABASE_URL check]        Health Checks
         â”‚                                       â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                          â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
    â”‚   DEMO    â”‚ YES                     â”‚ /health     â”‚
    â”‚  MODE?    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚ /live       â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â”‚               â”‚ /ready      â”‚
    NO   â”‚                â”‚               â”‚ /metrics    â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚               â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
    â”‚                   â”‚ â”‚                      â”‚
    â”‚   MySQL 8.0       â”‚ â”‚          Reports â”Œâ”€â”€â”€â”´â”€â”€â”€â”
    â”‚  (localhost:3306) â”‚ â”‚                  â”‚  âˆš    â”‚
    â”‚                   â”‚ â”‚                  â”‚ Stats â”‚
    â”‚ â€¢ energy_mgmt     â”‚ â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ â€¢ users table     â”‚ â”‚
    â”‚ â€¢ other tables    â”‚ â”‚
    â”‚                   â”‚ â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                         â”Œâ”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚ Demo User   â”‚
                         â”‚ In Memory   â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. Ø¯ÙˆØ±Ø© Ø­ÙŠØ§Ø© Ø§Ù„Ø·Ù„Ø¨ (Request Lifecycle)

```
CLIENT REQUEST
      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Express Server Receives Request      â”‚
â”‚    POST /api/trpc/auth.login            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Middleware Processing                â”‚
â”‚    â€¢ Helmet Security Headers            â”‚
â”‚    â€¢ Rate Limiting Check                â”‚
â”‚    â€¢ Body Parser                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. Context Creation (server/_core/context.ts)
â”‚                                         â”‚
â”‚    DEMO_MODE = !DATABASE_URL           â”‚
â”‚                                         â”‚
â”‚    â”œâ”€ DATABASE_URL âœ… â†’ Prod Mode      â”‚
â”‚    â””â”€ DATABASE_URL âŒ â†’ Demo Mode      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. Authentication (server/_core/sdk.ts) â”‚
â”‚                                         â”‚
â”‚    try {                                â”‚
â”‚      user = sdk.authenticateRequest()  â”‚
â”‚    } catch {                            â”‚
â”‚      if (DEMO_MODE)                    â”‚
â”‚        user = demoUser                 â”‚
â”‚    }                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                    â”‚
   DEMO MODE          DATABASE MODE
        â”‚                    â”‚
        â–¼                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Memory â”‚        â”‚   MySQL DB   â”‚
    â”‚ (Fast)â”‚        â”‚ (Persistent) â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. Business Logic Execution             â”‚
â”‚    (Routers / Procedures)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. Response                             â”‚
â”‚    JSON Response + Status Code          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
CLIENT RECEIVES RESPONSE
```

---

## 3. Ø¨Ù†ÙŠØ© Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MySQL Server                               â”‚
â”‚  (localhost:3306)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚  DATABASE: energy_management               â”‚
â”‚  CHARSET: utf8mb4                          â”‚
â”‚  COLLATION: utf8mb4_unicode_ci             â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ TABLE: users                     â”‚      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚  â”‚ â€¢ id (PK)                        â”‚      â”‚
â”‚  â”‚ â€¢ openId (UNIQUE)                â”‚      â”‚
â”‚  â”‚ â€¢ name                           â”‚      â”‚
â”‚  â”‚ â€¢ email                          â”‚      â”‚
â”‚  â”‚ â€¢ phone                          â”‚      â”‚
â”‚  â”‚ â€¢ password (hashed)              â”‚      â”‚
â”‚  â”‚ â€¢ role (admin/user)              â”‚      â”‚
â”‚  â”‚ â€¢ isActive                       â”‚      â”‚
â”‚  â”‚ â€¢ lastSignedIn                   â”‚      â”‚
â”‚  â”‚ â€¢ createdAt                      â”‚      â”‚
â”‚  â”‚ â€¢ updatedAt                      â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ [+50 Ø¬Ø¯ÙˆÙ„ Ø¢Ø®Ø±]                  â”‚      â”‚
â”‚  â”‚ (accounting, inventory, hr, etc) â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. Ù†Ù‚Ø§Ø· Ø§Ù„Ø§ØªØµØ§Ù„ ÙˆØ§Ù„ØªÙˆØ§Ø¨Ø¹ (Integration Points)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Application Initialization              â”‚
â”‚                                                  â”‚
â”‚  startServer() in server/_core/index.ts         â”‚
â”‚         â†“                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ 1. Setup Express                    â”‚       â”‚
â”‚  â”‚    â”œâ”€ Compression                   â”‚       â”‚
â”‚  â”‚    â”œâ”€ Helmet Security               â”‚       â”‚
â”‚  â”‚    â””â”€ Rate Limiting                 â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚             â†“                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ 2. Register Routes                  â”‚       â”‚
â”‚  â”‚    â”œâ”€ /health â†’ Health Checks       â”‚       â”‚
â”‚  â”‚    â”œâ”€ /api/oauth â†’ OAuth Routes     â”‚       â”‚
â”‚  â”‚    â”œâ”€ /api/trpc â†’ tRPC Router       â”‚       â”‚
â”‚  â”‚    â””â”€ /api/custom-system â†’ Custom   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚             â†“                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ 3. Setup Vite (Dev) / Static (Prod)â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚             â†“                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ 4. Ensure Default Admin             â”‚       â”‚
â”‚  â”‚    â””â”€ Calls getDb() + db functions  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚             â†“                                   â”‚
â”‚  Server Listening (PORT 5000)                  â”‚
â”‚                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. Ù…Ø³Ø§Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Data Flow)

```
AUTH MODULE (server/auth.ts)
      â†“
      â”œâ”€ getDb()
      â”‚  â”œâ”€ Check: DATABASE_URL exists?
      â”‚  â”‚   â”œâ”€ YES â†’ drizzle(DATABASE_URL)
      â”‚  â”‚   â””â”€ NO  â†’ _db = null (Demo Mode)
      â”‚  â””â”€ Return db instance
      â”‚
      â”œâ”€ hashPassword(pwd)
      â”‚  â””â”€ bcrypt.hash() â†’ 10 rounds
      â”‚
      â”œâ”€ registerUser(data)
      â”‚  â”œâ”€ Check duplicate
      â”‚  â”œâ”€ Hash password
      â”‚  â”œâ”€ Insert into users table
      â”‚  â””â”€ Return userId
      â”‚
      â”œâ”€ loginUser(phone, pwd)
      â”‚  â”œâ”€ Find user by phone
      â”‚  â”œâ”€ Verify password
      â”‚  â””â”€ Return user object
      â”‚
      â””â”€ ensureDefaultAdmin()
         â”œâ”€ Check if admin exists
         â”œâ”€ If NOT:
         â”‚  â””â”€ Create default admin
         â””â”€ If YES:
            â””â”€ Skip (already exists)
```

---

## 6. Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù… (Query Paths)

```
ØªØ·Ø¨ÙŠÙ‚ â†’ Request
         â†“
    ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙˆØ¶Ø¹:
    â”œâ”€ âœ… DATABASE_URL â†’ Ø§Ø³ØªØ®Ø¯Ù… MySQL
    â”‚  â”‚
    â”‚  â”œâ”€ getDb() â†’ Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ instance
    â”‚  â”‚
    â”‚  â”œâ”€ db.query() â†’ ØªÙ†ÙÙŠØ° Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…
    â”‚  â”‚  â””â”€ MySQL â† â†’ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    â”‚  â”‚
    â”‚  â””â”€ return result
    â”‚
    â””â”€ âŒ NO DATABASE_URL â†’ Ø§Ø³ØªØ®Ø¯Ù… Demo Mode
       â”‚
       â”œâ”€ Ø¥Ø±Ø¬Ø§Ø¹ Ù…Ø³ØªØ®Ø¯Ù… ØªØ¬Ø±ÙŠØ¨ÙŠ
       â”‚
       â””â”€ Ù„Ø§ ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø¯Ø§Ø¦Ù…Ø©
```

---

## 7. Health Check Flow

```
GET /health
    â†“
getHealthStatus()
    â†“
    â”œâ”€ Check if database connected
    â”‚  â”œâ”€ Execute: SELECT 1
    â”‚  â”œâ”€ Success? â†’ database = "connected"
    â”‚  â””â”€ Failure? â†’ database = "disconnected"
    â”‚
    â”œâ”€ Measure response time
    â”‚
    â”œâ”€ Check process uptime
    â”‚
    â””â”€ Return status object
       {
         status: "healthy" | "degraded" | "unhealthy",
         database: "connected" | "disconnected",
         responseTime: <ms>,
         uptime: <seconds>,
         timestamp: <ISO8601>
       }
```

---

## 8. Connection Pool Management

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ConnectionPoolManager              â”‚
â”‚    (server/database/connection-pool.ts)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚  Pool Config:                        â”‚
â”‚  â€¢ Max Connections: 10               â”‚
â”‚  â€¢ Min Connections: 2                â”‚
â”‚  â€¢ Timeout: 30000ms                 â”‚
â”‚  â€¢ Idle Timeout: 900000ms           â”‚
â”‚                                      â”‚
â”‚  Methods:                            â”‚
â”‚  â”œâ”€ acquire()   â†’ Get connection    â”‚
â”‚  â”œâ”€ release()   â†’ Return connection â”‚
â”‚  â”œâ”€ getStats()  â†’ Pool statistics   â”‚
â”‚  â””â”€ health()    â†’ Check pool health â”‚
â”‚                                      â”‚
â”‚  Stats Tracked:                      â”‚
â”‚  â€¢ totalConnections                  â”‚
â”‚  â€¢ busyConnections                   â”‚
â”‚  â€¢ idleConnections                   â”‚
â”‚  â€¢ waitingRequests                   â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 9. Error Handling Chain

```
Database Operation Request
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Try    â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
         â†“
    Execute Query
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚          â”‚
  âœ… SUCCESS   âŒ ERROR
    â”‚          â”‚
    â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                       â†“
    â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                  â”‚ Catch Block     â”‚
    â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                  â”‚ Log Error       â”‚
    â”‚                  â”‚ Return null/_db â”‚
    â”‚                  â”‚ Fallback Mode   â”‚
    â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                           â”‚
    â–¼                           â–¼
Return Data              DEMO Mode Fallback
                         (Safe Operation)
```

---

## 10. Ø§Ù„ÙˆØ¶Ø¹ÙŠØ§Øª ÙˆØ§Ù„ØªØ­ÙˆÙ„Ø§Øª

```
System States:
    
    START
      â†“
    [Check DATABASE_URL]
      â†“
    â”Œâ”€â”´â”€â”
    â”‚   â”‚
 PROD â”œâ”€ DEMO
    â”‚   â”‚
    â”œâ”€â†’ âœ… Connected to MySQL
    â”‚   â””â”€ All features active
    â”‚   â””â”€ Data persisted
    â”‚
    â””â”€â†’ âš ï¸ Demo Mode
        â””â”€ Memory storage
        â””â”€ Limited features
        â””â”€ Test data only

Transitions:
    DEMO â†’ PROD
    (After configuring DATABASE_URL and restarting)
    
    PROD â†’ DEMO
    (If database connection fails, graceful degradation)
```

---

**Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«:** January 2, 2026  
**Ø§Ù„Ù†Ø³Ø®Ø©:** 2.1.0  
**Ø§Ù„Ø­Ø§Ù„Ø©:** âœ… ÙŠØ¹Ù…Ù„ Ø¨Ù†Ø¬Ø§Ø­

