# ⬛ قواعد الأتمتة والـ CI/CD (Automation & CI/CD)

> **الفئة:** الأتمتة والـ CI/CD  
> **عدد القواعد:** 2 قواعد  
> **مستوى الأهمية:** حرج

---

## القاعدة 41: الفحص الآلي قبل الدمج (Pre-merge Checks Rule)

> **لا يُدمج أي كود بدون اجتياز جميع الفحوصات الآلية.**

**الفحوصات المطلوبة:**

```yaml
# .github/workflows/ci.yml
name: CI Pipeline

on: [push, pull_request]

jobs:
  check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Install dependencies
        run: pnpm install
      
      - name: Type Check
        run: pnpm run check
      
      - name: Lint
        run: pnpm run lint
      
      - name: Unit Tests
        run: pnpm run test
      
      - name: Build
        run: pnpm run build
      
      - name: Security Audit
        run: pnpm audit
```

**قائمة الفحوصات الإلزامية:**

| الفحص | الأمر | الغرض |
|:---|:---|:---|
| **Type Check** | `pnpm run check` | التحقق من أنواع TypeScript |
| **Lint** | `pnpm run lint` | فحص جودة الكود |
| **Unit Tests** | `pnpm run test` | اختبارات الوحدة |
| **Build** | `pnpm run build` | التأكد من نجاح البناء |
| **Security Audit** | `pnpm audit` | فحص الثغرات الأمنية |

**العقوبة:** رفض الدمج تلقائياً - أي فشل في CI يمنع الدمج.

---

## القاعدة 42: رسائل الـ Commit الواضحة (Commit Message Rule)

> **كل commit يجب أن يكون له رسالة واضحة تتبع نمطاً محدداً.**

**نمط الرسالة:**
```
<type>(<scope>): <subject>

<body>

<footer>
```

**أنواع الـ Commit:**

| النوع | الاستخدام | مثال |
|:---|:---|:---|
| `feat` | ميزة جديدة | `feat(users): إضافة شاشة إدارة المستخدمين` |
| `fix` | إصلاح خطأ | `fix(auth): إصلاح مشكلة انتهاء الجلسة` |
| `docs` | توثيق | `docs(api): توثيق endpoints المستخدمين` |
| `style` | تنسيق (لا يغير الكود) | `style(ui): تحسين تنسيق الأزرار` |
| `refactor` | إعادة هيكلة | `refactor(db): تحسين استعلامات الإهلاك` |
| `test` | اختبارات | `test(users): إضافة اختبارات للمستخدمين` |
| `chore` | مهام صيانة | `chore(deps): تحديث التبعيات` |

**أمثلة:**
```bash
# ✅ صحيح
feat(users): إضافة شاشة إدارة المستخدمين
fix(auth): إصلاح مشكلة انتهاء الجلسة
docs(api): توثيق endpoints المستخدمين
refactor(db): تحسين استعلامات الإهلاك

# ❌ خطأ
"تعديلات"
"fix"
"update"
"asdfgh"
```

**العقوبة:** رفض الدمج - رسائل غير واضحة تُرفض.

---

## ملخص قواعد الأتمتة

| # | القاعدة | العقوبة |
|:---:|:---|:---:|
| 41 | الفحص الآلي قبل الدمج (CI Pipeline) | رفض تلقائي |
| 42 | رسائل Commit الواضحة | رفض |
