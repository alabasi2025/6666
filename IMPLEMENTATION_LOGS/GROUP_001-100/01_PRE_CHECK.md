# ๐ ุงููุญุต ุงูุฃููู - ุงููุฌููุนุฉ 001-100
## Pre-Implementation Check

**ุชุงุฑูุฎ ุงููุญุต:** 2026-01-08  
**ุงูููุงู:** 1-100 (Cron Jobs, SMS, WhatsApp, Email, Payment Gateways, Business Context)

---

## ๐ ุงูููุงู ุงููุณุชูุฏูุฉ:

1. โ Cron Jobs (15 ูููุฉ)
2. โ SMS Integration (3 ููุงู)
3. โ WhatsApp Integration (3 ููุงู)
4. โ Email Integration (2 ููุงู)
5. โ Messaging Service (5 ููุงู)
6. โ Notification Queue (5 ููุงู)
7. โ Message Templates (3 ููุงู)
8. โ Payment Gateways - Phase 1 (10 ููุงู)
9. โ Business Context (15 ููุงู)
10. โ ููุงู ุญุฑุฌุฉ ุฃุฎุฑู (~39 ูููุฉ)

---

## ๐ ูุชุงุฆุฌ ุงููุญุต:

### 1. Cron Jobs - ุงููุญุต

#### โ ุงูููุฌูุฏ:
- **ุงูููู:** `server/core/cron-jobs.ts` โ ููุฌูุฏ
- **ุงููููู:** ููุฌูุฏ ุจุงููุงูู (15 Cron Job)
- **ุงูุฌุฏููุฉ:** ุชุนูู (ุชู ุงูุชุญูู ูู initialization)

#### โ๏ธ ุงููุงูุต:
```typescript
// ุงูุณุทุฑ 68: TODO
// TODO: ุชูููุฐ ุงูููุชุฑุฉ ุงูุชููุงุฆูุฉ
logger.info("Auto-billing job completed");

// ุงูุณุทุฑ 105: TODO
// TODO: ุงุณุชุฏุนุงุก ACREL API ูุดุญู ุงูุญุตุฉ

// ุงูุณุทุฑ 164: TODO
// TODO: ุฅุฑุณุงู ุงูุชูุฑูุฑ ููุฌูุงุช ุงููุนููุฉ

// ุงูุณุทุฑ 199: TODO
// TODO: ุงุณุชุฏุนุงุก ุฏุงูุฉ ุญุณุงุจ ุงูุฅููุงู

// ุงูุณุทุฑ 223: TODO
// TODO: ูุนุงูุฌุฉ ุณุฌูุงุช ุงูุญุถูุฑ ูู ุฃุฌูุฒุฉ ุงูุจุตูุฉ

// ุงูุณุทุฑ 262: TODO
// TODO: ุงุณุชุฏุนุงุก SMS Service
```

#### ๐ฏ ุงูุฅุฌุฑุงุก ุงููุทููุจ:
- โ **ุงุณุชููุงู ููุท** (ูุง ุจูุงุก ูู ุฌุฏูุฏ)
- ุงุณุชุจุฏุงู ูู `// TODO:` ุจููุฏ ูุนูู
- ุฅูุดุงุก Services ุงููุณุงุนุฏุฉ (ุฅู ูุฒู ุงูุฃูุฑ)

---

### 2. SMS Integration - ุงููุญุต

#### โ ุงูููุฌูุฏ:
- **ุงูููู:** `server/notifications/channels/sms.ts` โ ููุฌูุฏ
- **ุงูู Class:** `SmsChannel` ููุฌูุฏ
- **ุงููุธุงุฆู:** `send()`, `formatSmsMessage()` ููุฌูุฏุฉ

#### โ๏ธ ุงููุงูุต:
```typescript
// ุงูุณุทุฑ 42
logger.debug('Sending SMS', { to: recipient.phone, message });
return { success: true, ... };  // โ ูุญุงูุงุฉ ููุท
```

#### ๐ฏ ุงูุฅุฌุฑุงุก ุงููุทููุจ:
- โ **ุงุณุชููุงู ููุท**
- ุฅุถุงูุฉ ุชูุงูู ูุนูู ูุน Twilio/Unifonic
- ุชูุนูู ุงูุฅุฑุณุงู ุงูุญูููู

#### โ ุบูุฑ ููุฌูุฏ (ูุญุชุงุฌ ุจูุงุก):
- ุฌุฏูู `sms_logs` (ูุชุณุฌูู ุฌููุน ุงูุฑุณุงุฆู)

---

### 3. WhatsApp Integration - ุงููุญุต

#### โ ุงูููุฌูุฏ:
- **ุงูููู:** `server/notifications/channels/whatsapp.ts` โ ููุฌูุฏ
- **ุงูู Class:** `WhatsAppChannel` ููุฌูุฏ
- **ุงููุธุงุฆู:** `send()`, `sendInvoice()`, `sendPaymentReminder()` ููุฌูุฏุฉ

#### โ๏ธ ุงููุงูุต:
```typescript
// ุงูุณุทุฑ 51-57
// TODO: ุชูุงูู ูุนูู ูุน Twilio
logger.info('WhatsApp message sent (simulated)', { ... });
```

#### ๐ฏ ุงูุฅุฌุฑุงุก ุงููุทููุจ:
- โ **ุงุณุชููุงู ููุท**
- ุชูุนูู ุงูุชูุงูู ุงููุนูู ูุน Twilio WhatsApp API

#### โ ุบูุฑ ููุฌูุฏ (ูุญุชุงุฌ ุจูุงุก):
- ุฌุฏูู `whatsapp_logs`

---

### 4. Email Integration - ุงููุญุต

#### โ ุบูุฑ ููุฌูุฏ:
- **ุงูููู:** `server/notifications/channels/email.ts` โ ุบูุฑ ููุฌูุฏ
- **ุงูู Class:** `EmailChannel` ุบูุฑ ููุฌูุฏ

#### ๐ฏ ุงูุฅุฌุฑุงุก ุงููุทููุจ:
- โ **ุจูุงุก ูู ุงูุตูุฑ**
- ุฅูุดุงุก `email.ts` ูุงูู
- ุชูุงูู ูุน SMTP/SendGrid/AWS SES
- ุฅูุดุงุก ุฌุฏูู `email_logs`

---

### 5. Messaging Service - ุงููุญุต

#### โ ุงูููุฌูุฏ:
- **ุงูููู:** `server/messagingRouter.ts` โ ููุฌูุฏ
- **ุงูู Router:** ููุฌูุฏ ูุน ุฌููุน endpoints

#### โ๏ธ ุงููุงูุต:
```typescript
// ุงูุณุทุฑ 205: TODO
// TODO: ุชูููุฐ ููุทู ุฅุฑุณุงู ุงููุงุชูุฑุฉ
return { success: true, message: "ุชู ุฅุฑุณุงู ุงููุงุชูุฑุฉ ุจูุฌุงุญ" };

// ุงูุณุทุฑ 241: TODO
// TODO: ุชูููุฐ ููุทู ุฅุฑุณุงู ุงูุชุฐููุฑ

// ุงูุณุทุฑ 272: TODO
// TODO: ุชูููุฐ ููุทู ุฅุฑุณุงู ุชุฃููุฏ ุงูุฏูุน
```

#### ๐ฏ ุงูุฅุฌุฑุงุก ุงููุทููุจ:
- โ **ุงุณุชููุงู ููุท**
- ุงุณุชุจุฏุงู `// TODO:` ุจููุฏ ูุนูู
- ุฑุจุท ูุน `smsChannel`, `whatsappChannel`, `emailChannel`

#### โ ุบูุฑ ููุฌูุฏ (ูุญุชุงุฌ ุจูุงุก):
- Service `invoice-notification-service.ts`
- ุฌุฏูู `invoice_notifications`

---

### 6. Notification Queue - ุงููุญุต

#### โ ุบูุฑ ููุฌูุฏ:
- **ุงูููู:** `server/services/notification-queue.ts` โ ุบูุฑ ููุฌูุฏ
- **ุฌุฏูู:** `notification_queue` โ ุบูุฑ ููุฌูุฏ
- **Cron Job:** ูุฅุนุงุฏุฉ ุงููุญุงููุฉ โ ุบูุฑ ููุฌูุฏ

#### ๐ฏ ุงูุฅุฌุฑุงุก ุงููุทููุจ:
- โ **ุจูุงุก ูู ุงูุตูุฑ**
- ุฅูุดุงุก ุฌุฏูู `notification_queue` ูู schema
- ุฅูุดุงุก Service ููู Queue
- ุฅูุดุงุก Cron Job ูุฅุนุงุฏุฉ ุงููุญุงููุฉ

---

### 7. Message Templates - ุงููุญุต

#### โ ุบูุฑ ููุฌูุฏ:
- **ุฌุฏูู:** `message_templates` โ ุบูุฑ ููุฌูุฏ
- **ูุงุฌูุฉ:** ูุฅุฏุงุฑุฉ ุงูููุงูุจ โ ุบูุฑ ููุฌูุฏุฉ
- **API:** `templatesRouter` โ ุบูุฑ ููุฌูุฏ

#### ๐ฏ ุงูุฅุฌุฑุงุก ุงููุทููุจ:
- โ **ุจูุงุก ูู ุงูุตูุฑ**
- ุฅูุดุงุก ุฌุฏูู `message_templates`
- ุฅูุดุงุก Router
- ุฅูุดุงุก ูุงุฌูุฉ Frontend

---

### 8. Payment Gateways - ุงููุญุต

#### โ ุงูููุฌูุฏ:
- **ุงูููู:** `server/paymentGatewaysRouter.ts` โ ููุฌูุฏ
- **ุฌุฏุงูู:** `payment_gateways`, `payment_transactions` โ ููุฌูุฏุฉ
- **ูุงุฌูุฉ:** `PaymentGatewaysSettings.tsx` โ ููุฌูุฏุฉ

#### โ๏ธ ุงููุงูุต:
```typescript
// ุงูุณุทุฑ 140: TODO
// TODO: ุชูููุฐ ุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุงููุนูู ูุน ุจูุงุจุฉ ุงูุฏูุน

// ุงูุณุทุฑ 207: TODO
// TODO: ุงุณุชุฏุนุงุก API ุจูุงุจุฉ ุงูุฏูุน ูุฅูุดุงุก ุงููุนุงููุฉ

// ุงูุณุทุฑ 463: TODO
// TODO: ุชูููุฐ ุงุณุชุฏุนุงุก API ูุนูู ุญุณุจ ููุน ุงูุจูุงุจุฉ
```

#### ๐ฏ ุงูุฅุฌุฑุงุก ุงููุทููุจ:
- โ **ุงุณุชููุงู ููุท**
- ุฅูุดุงุก Services ููุชูุงูู:
  - `server/services/payment-gateways/moyasar.ts` โ ุบูุฑ ููุฌูุฏ
  - `server/services/payment-gateways/sadad.ts` โ ุบูุฑ ููุฌูุฏ

#### โ๏ธ Webhooks:
- **ุงูููู:** `server/webhooks/payment-webhooks.ts` โ ููุฌูุฏ
- **ุงููุงูุต:** ุงูุชุญูู ูู ุงูุชูููุน (HMAC) - TODO ูู ุงูุณุทุฑ 241, 259

---

### 9. Business Context - ุงููุญุต

#### โ๏ธ ุงููุดููุฉ:
ุฌููุน ุตูุญุงุช Frontend ุชุณุชุฎุฏู `businessId = 1` hardcoded

**ุงููููุงุช ุงููุชุฃุซุฑุฉ (25 ููู):**
```typescript
// client/src/pages/mobile-apps/MobileAppsManagement.tsx:19
businessId: 1, // TODO: Get from context

// client/src/pages/acrel/AcrelPaymentSettings.tsx:38
const businessId = 1; // TODO: Get from context

// client/src/pages/sts/STSCharging.tsx:64
const businessId = 1; // TODO: Get from context

// ... 22 ููู ุขุฎุฑ
```

#### โ ุบูุฑ ููุฌูุฏ:
- **Context Provider:** `BusinessContext.tsx` โ ุบูุฑ ููุฌูุฏ
- **Business Switcher:** ูู Header/Sidebar โ ุบูุฑ ููุฌูุฏ

#### ๐ฏ ุงูุฅุฌุฑุงุก ุงููุทููุจ:
- โ **ุจูุงุก Context ูู ุงูุตูุฑ**
- โ **ุงุณุชููุงู** 25 ููู ููุฌูุฏ (ุงุณุชุจุฏุงู hardcoded values)

---

## ๐ ููุฎุต ุงููุญุต:

| ุงููููู | ุงูุญุงูุฉ | ุงูุฅุฌุฑุงุก |
|--------|---------|---------|
| **Cron Jobs** | โ ููุฌูุฏ | โ๏ธ ุงุณุชููุงู (ุงุณุชุจุฏุงู TODOs) |
| **SMS Channel** | โ ููุฌูุฏ | โ๏ธ ุงุณุชููุงู (ุชูุนูู ุงูุฅุฑุณุงู) |
| **WhatsApp Channel** | โ ููุฌูุฏ | โ๏ธ ุงุณุชููุงู (ุชูุนูู ุงูุฅุฑุณุงู) |
| **Email Channel** | โ ุบูุฑ ููุฌูุฏ | โ ุจูุงุก ูู ุงูุตูุฑ |
| **Messaging Router** | โ ููุฌูุฏ | โ๏ธ ุงุณุชููุงู (ุงุณุชุจุฏุงู TODOs) |
| **Notification Queue** | โ ุบูุฑ ููุฌูุฏ | โ ุจูุงุก ูู ุงูุตูุฑ |
| **Message Templates** | โ ุบูุฑ ููุฌูุฏ | โ ุจูุงุก ูู ุงูุตูุฑ |
| **Payment Gateways** | โ ููุฌูุฏ | โ๏ธ ุงุณุชููุงู (ุชูุนูู APIs) |
| **Business Context** | โ ุบูุฑ ููุฌูุฏ | โ ุจูุงุก Context + โ๏ธ ุงุณุชููุงู 25 ููู |

---

## ๐ ุงูุฅุญุตุงุฆูุงุช:

```
ุงูููุงู ุงููุณุชูุฏูุฉ: 100

ุชุตููู ุงูููุงู:
โโโ ุงุณุชููุงู ุดูุก ููุฌูุฏ: 60 ูููุฉ (60%)
โโโ ุจูุงุก ูู ุงูุตูุฑ: 40 ูููุฉ (40%)

ุงูุชูุตูู:
โโโ ุงุณุชููุงู TODOs: 35 ูููุฉ
โโโ ุชูุนูู APIs ุฎุงุฑุฌูุฉ: 15 ูููุฉ
โโโ ุฅูุดุงุก Services ุฌุฏูุฏุฉ: 10 ููุงู
โโโ ุฅูุดุงุก ุฌุฏุงูู ุฌุฏูุฏุฉ: 8 ููุงู
โโโ ุฅูุดุงุก ูุงุฌูุงุช ุฌุฏูุฏุฉ: 12 ูููุฉ
โโโ ุฅูุดุงุก Context Provider: 1 ูููุฉ
โโโ ุชุญุฏูุซ ูููุงุช ููุฌูุฏุฉ: 25 ูููุฉ
โโโ ุงุฎุชุจุงุฑ ูุชูุซูู: 4 ููุงู
```

---

## โ ุงูุฎุทูุฉ ุงูุชุงููุฉ:

ุจูุงุกู ุนูู ุงููุญุตุ ุณูุจุฏุฃ ุจู:

### ุงูุฃููููุฉ 1 (ุญุฑุฌุฉ):
1. โ ุชูุนูู SMS (ุงุณุชููุงู `sms.ts`)
2. โ ุชูุนูู WhatsApp (ุงุณุชููุงู `whatsapp.ts`)
3. โ ุฅูุดุงุก Email Channel ูู ุงูุตูุฑ
4. โ ุชูุนูู Cron Job: Auto-Billing (ุงุณุชุจุฏุงู TODO)
5. โ ุชูุนูู Messaging Service (ุงุณุชุจุฏุงู TODOs)

### ุงูุฃููููุฉ 2 (ุนุงููุฉ):
6. โ ุฅูุดุงุก Notification Queue
7. โ ุชูุนูู Payment Gateways
8. โ ุฅูุดุงุก Business Context

### ุงูุฃููููุฉ 3 (ูุชูุณุทุฉ):
9. โ ุฅูุดุงุก Message Templates
10. โ ุจุงูู Cron Jobs

---

## ๐ ุงูุงุณุชุนุฏุงุฏ ููุจุฏุก:

```bash
# 1. ุฅูุดุงุก branch ุฌุฏูุฏ
cd 6666-main
git checkout -b feature/tasks-001-100

# 2. ุชุซุจูุช ุงูููุชุจุงุช ุงููุทููุจุฉ
pnpm add twilio @types/twilio
pnpm add nodemailer @types/nodemailer
pnpm add unifonic  # ุฃู ุฃู ูุฒูุฏ SMS ุขุฎุฑ

# 3. ุฅุถุงูุฉ ูุชุบูุฑุงุช ุงูุจูุฆุฉ
# ุฅูุดุงุก .env.local ูุฅุถุงูุฉ:
# SMS_PROVIDER=twilio
# SMS_API_KEY=...
# WHATSAPP_ACCOUNT_SID=...
# SMTP_HOST=...
# ... ุฅูุฎ

# 4. ุงูุจุฏุก ุจุฃูู ูููุฉ
# ุชูุนูู SMS ูู server/notifications/channels/sms.ts
```

---

**ุญุงูุฉ ุงููุญุต:** โ ููุชูู  
**ุฌุงูุฒ ููุจุฏุก:** โ ูุนู  
**ุงูุชุงุฑูุฎ:** 2026-01-08
